<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>New Peace Studio</title>
<style>
  body { 
    font-family: monospace; 
    background: #1e1e1e; 
    color: #f5f5f5; 
    margin:0; padding:10px; 
  }
  h2 { text-align:center; margin-bottom:10px; font-size:1.5em; }

  #editor {
    width: 100%;
    min-height: 200px;
    background: #2e2e2e;
    color: #f5f5f5;
    padding: 10px;
    margin-bottom: 10px;
    border-radius: 8px;
    box-sizing: border-box;
    font-size: 1em;
    overflow-y: auto;
  }

  #output {
    width: 100%;
    height: 200px;
    background: #111;
    color: #0f0;
    padding: 10px;
    overflow-y: auto;
    white-space: pre-wrap;
    word-wrap: break-word;
    border-radius: 8px;
    box-sizing: border-box;
    margin-bottom: 10px;
  }

  select, button {
    margin: 5px 2px;
    padding: 8px 12px;
    font-size: 1em;
    border-radius: 5px;
    border: none;
    cursor: pointer;
  }

  button:hover { background: #444; color: #fff; }

  @media (max-width: 600px) {
    #editor, #output { min-height: 150px; font-size: 0.9em; }
    select, button { width: 48%; font-size: 0.9em; padding: 6px 0; }
  }
</style>
</head>
<body>

<h2>New Peace Studio</h2>

<select id="languageSelect">
  <option value="python">Python</option>
  <option value="js">JavaScript</option>
  <option value="html">HTML</option>
</select>
<button onclick="createProject()">New Project</button>
<button onclick="saveCurrentProject()">Save</button>
<button onclick="runCode()">▶ Run</button>

<div id="editor" contenteditable="true">print("Hello!")</div>
<div id="output"></div>

<script>
let currentLang = "python";
let currentProject = null;

function log(text) {
    const out = document.getElementById("output");
    out.textContent += text + "\n";
    out.scrollTop = out.scrollHeight; // автопрокрутка вниз
}

function createProject() {
    const name = prompt("Project name:");
    if (!name) return;
    const projects = JSON.parse(localStorage.getItem(`projects_${currentLang}`) || "[]");
    projects.push({ name, code: "" });
    localStorage.setItem(`projects_${currentLang}`, JSON.stringify(projects));
    log(`Project "${name}" created`);
}

function saveCurrentProject() {
    if (currentProject === null) return;
    const code = document.getElementById("editor").textContent;
    const projects = JSON.parse(localStorage.getItem(`projects_${currentLang}`) || "[]");
    projects[currentProject].code = code;
    localStorage.setItem(`projects_${currentLang}`, JSON.stringify(projects));
    log(`Project saved`);
}

function runCode() {
    const code = document.getElementById("editor").textContent;
    currentLang = document.getElementById("languageSelect").value;

    if(currentLang === "python") {
        // Python здесь только как текст (эмуляция)
        log("⚠ Python execution not supported. Output is textual only.");
    } else if(currentLang === "js") {
        try {
            const result = eval(code);
            log(result !== undefined ? result : "✅ JS executed");
        } catch(e) { log("❌ JS Error: " + e); }
    } else if(currentLang === "html") {
        const iframe = document.createElement("iframe");
        iframe.style.width="100%";
        iframe.style.height="200px";
        document.getElementById("output").appendChild(iframe);
        iframe.contentDocument.open();
        iframe.contentDocument.write(code);
        iframe.contentDocument.close();
        log("✅ HTML rendered");
    } else {
        log("⚠ Language not supported");
    }
}
</script>

</body>
</html>
